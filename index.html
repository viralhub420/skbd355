<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKBD Premium Rewards</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
        body { background:#0f0f0f; color:#ffffff; text-align:center; font-family: 'Segoe UI', sans-serif; padding:15px; margin: 0; }
        .balance-card { background: linear-gradient(135deg, #0088cc, #005f91); padding: 25px; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        .balance-card h1 { font-size: 42px; margin: 10px 0; }
        .refer-section { background: #1e1e1e; padding: 15px; border-radius: 15px; margin-bottom: 20px; border: 1px dashed #0088cc; }
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        button { padding: 16px; border: none; border-radius: 15px; font-weight: bold; cursor: pointer; font-size: 14px; color: white; transition: 0.2s; }
        button:active { transform: scale(0.95); }
        .btn-main { background: #27ae60; grid-column: span 2; }
        .btn-game { background: #2980b9; }
        .btn-offer { background: #8e44ad; }
        .btn-rules { background: #e74c3c; grid-column: span 2; margin-top: 10px; }
        .btn-ref { background: #f39c12; grid-column: span 2; }
        #adminBtn { background: #d35400; margin-top: 20px; width: 100%; display: none; }
        .review-btn { background: #f1c40f !important; color: #000 !important; font-size: 13px !important; padding: 10px 5px !important; }
    </style>
</head>
<body>
    <div class="header"><h3>Welcome, <span id="userName">User</span>!</h3></div>
    <div class="balance-card">
        <p>Current Balance</p>
        <h1 id="userBalance">0</h1>
    </div>

    <div class="refer-section">
        <p style="margin:0 0 10px 0; font-size:14px;">ğŸ à¦ªà§à¦°à¦¤à¦¿ à¦°à§‡à¦«à¦¾à¦°à§‡ à¦ªà¦¾à¦¨ à§§à§¦à§¦ à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ!</p>
        <button class="btn-ref" id="shareBtn">ğŸ”— Invite Friends & Earn </button>
    </div>

    <div class="btn-grid">
        <button class="btn-main" onclick="awardCoins(20, 85, LINKS.general, 'Daily Bonus')">ğŸ Daily Bonus (+20)</button>
        <button class="btn-game" onclick="awardCoins(20, 85, LINKS.game, 'Game Bonus')">ğŸ® Play Game (+20)</button>
        <button class="btn-offer" onclick="awardCoins(20, 85, LINKS.offer, 'Mega Offer')">ğŸ§² Offer Wall (+20)</button>
        <button class="btn-ad" style="background: #f1c40f; color: #000; border: none;" onclick="awardCoins(15, 60, LINKS.general, 'Ad Reward')">ğŸ“º Watch Ad (+15)</button>
        <button class="btn review-btn" onclick="openReview()"> â­ Review (+10)</button>
        <button class="btn-rules" id="rulesBtn">ğŸ“œ Rules & Information</button>
        <button class="btn-ad" style="background:#16a085; grid-column: span 2;" onclick="tg.openLink('https://t.me/skbd355_official')">ğŸ“¢ Official Channel</button>
    </div>
    
    <button id="adminBtn">ğŸ›  Admin Dashboard</button>
    
<script>
const LINKS = { 
    general: "https://otieu.com/4/10540712", 
    game: "https://otieu.com/4/10235751", 
    offer: "https://otieu.com/4/10453524" 
};

firebase.initializeApp({ 
    apiKey: "AIzaSyD8ZSiPZ9HDJV1qGznPOBAu2qYN9lmSqWU", 
    authDomain: "skbd355-reward-app.firebaseapp.com", 
    projectId: "skbd355-reward-app" 
});

const db = firebase.firestore();
const tg = window.Telegram.WebApp;
const user = tg.initDataUnsafe?.user;
const startParam = tg.initDataUnsafe?.start_param; 
let userRef;

if (user) {
    document.getElementById("userName").innerText = user.first_name;
    userRef = db.collection("users").doc(String(user.id));
    if (user.id === 6311806060) document.getElementById("adminBtn").style.display = "block";

    userRef.onSnapshot(doc => {
        if (doc.exists) {
            document.getElementById("userBalance").innerText = doc.data().balance;
        } else {
            userRef.set({ name: user.first_name, balance: 0, telegram_id: user.id, joined_at: new Date() })
            .then(() => {
                if (startParam && startParam !== String(user.id)) {
                    db.collection("users").doc(startParam).update({ balance: firebase.firestore.FieldValue.increment(100) });
                }
            });
        }
    });
}

function openReview() {
    window.open("https://otieu.com/4/10370640", "_blank");
    setTimeout(function() { window.location.href = "https://t.me/skbd355_official"; }, 5000);
    alert("à¦…à§à¦¯à¦¾à¦¡à¦Ÿà¦¿ à¦¦à§‡à¦–à§‡ à¦°à¦¿à¦­à¦¿à¦‰ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à§§à§¦ à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦¬à§‹à¦¨à¦¾à¦¸ à¦¨à¦¿à¦¨!");
}

function showRules() {
    tg.showAlert(`ğŸ“œ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¨à¦¿à§Ÿà¦®à¦¾à¦¬à¦²à§€:\n\nà§§. à¦¬à¦¿à¦œà§à¦à¦¾à¦ªà¦¨à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à¦¾à¦° à¦ªà¦° à¦…à¦¬à¦¶à§à¦¯à¦‡ à¦…à§à¦¯à¦¾à¦¡ à¦¦à§‡à¦–à¦¾ à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡à¥¤\nà§¨. à¦­à§à¦² à¦•à§à¦²à¦¿à¦• à¦•à¦°à¦²à§‡ à¦•à§Ÿà§‡à¦¨ à¦¯à§‹à¦— à¦¹à¦¬à§‡ à¦¨à¦¾à¥¤\nà§©. à§«à§¦à§¦à§¦ à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦¹à¦²à§‡ à¦ªà§Ÿà§‡à¦¨à§à¦Ÿ à¦­à¦¾à¦™à¦¿à§Ÿà§‡ à¦¬à¦¿à¦•à¦¾à¦¶, à¦¨à¦—à¦¦ à¦¬à¦¾ à¦°à¦•à§‡à¦Ÿà§‡ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¨à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨à¥¤\nà§ª. à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à§¨à§ª à¦˜à¦¨à§à¦Ÿà¦¾à¦° à¦®à¦§à§à¦¯à§‡ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤\nà§«. à¦¬à§‡à¦¶à¦¿ à¦‡à¦¨à¦•à¦¾à¦®à§‡à¦° à¦œà¦¨à§à¦¯ USA à¦¬à¦¾ UK VPN à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§à¦¨à¥¤\n\nâš ï¸ à¦¬à¦¿à¦¶à§‡à¦· à¦¦à§à¦°à¦·à§à¦Ÿà¦¬à§à¦¯: à¦ªà§Ÿà§‡à¦¨à§à¦Ÿ à¦®à¦¾à¦¨à§‡à¦‡ à¦Ÿà¦¾à¦•à¦¾ à¦¨à§Ÿà¥¤`);
}

function shareReferral() {
    const inviteLink = `https://t.me/skbd355_bot?start=${user.id}`; 
    const shareText = `ğŸš€ à¦à¦‡ à¦…à§à¦¯à¦¾à¦ªà§‡ à¦—à§‡à¦® à¦–à§‡à¦²à§‡ à¦†à¦° à¦­à¦¿à¦¡à¦¿à¦“ à¦¦à§‡à¦–à§‡ à¦Ÿà¦¾à¦•à¦¾ à¦‡à¦¨à¦•à¦¾à¦® à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ! à¦œà§Ÿà§‡à¦¨ à¦•à¦°à¦²à§‡à¦‡ à¦¬à§‹à¦¨à¦¾à¦¸ à¦ªà¦¾à¦¬à§‡à¦¨:`;
    tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(inviteLink)}&text=${encodeURIComponent(shareText)}`);
}

function awardCoins(amount, time, link, taskName) {
    tg.showConfirm(`${taskName}: à¦¬à¦¿à¦œà§à¦à¦¾à¦ªà¦¨à§‡ ${time} à¦¸à§‡à¦•à§‡à¦¨à§à¦¡ à¦¥à¦¾à¦•à¦²à§‡ à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦ªà¦¾à¦¬à§‡à¦¨à¥¤ à¦¶à§à¦°à§ à¦•à¦°à¦¬à§‡à¦¨?`, (ok) => {
        if (ok) {
            tg.openLink(link);
            setTimeout(() => {
                userRef.update({ balance: firebase.firestore.FieldValue.increment(amount) });
                tg.showAlert(`âœ… ${amount} à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦¯à§‹à¦— à¦¹à§Ÿà§‡à¦›à§‡!`);
            }, time * 1000);
        }
    });
}

function toggleAdmin() {
    db.collection("withdraws").where("status", "==", "pending").get().then(snap => {
        let list = "ğŸ“¢ à¦ªà§‡à¦¨à§à¦¡à¦¿à¦‚ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦²à¦¿à¦¸à§à¦Ÿ:\n\n";
        snap.forEach(doc => { 
            let d = doc.data();
            let method = d.method ? d.method.toUpperCase() : 'N/A';
            let num = d.number || d.payment_number || 'N/A';
            list += `ğŸ“± ${method}: ${num}\nğŸ’° Amt: ${d.amount}\n\n`; 
        });
        alert(list || "à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨à§‡ à¦•à§‹à¦¨à§‹ à¦ªà§‡à¦¨à§à¦¡à¦¿à¦‚ à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿ à¦¨à§‡à¦‡à¥¤");
    }).catch(err => alert("Error: " + err.message));
}

// à¦¬à¦¾à¦Ÿà¦¨à¦—à§à¦²à§‹ à¦¸à¦šà¦² à¦•à¦°à¦¾à¦° à¦•à§‹à¦¡
document.getElementById("rulesBtn").onclick = () => showRules();
document.getElementById("adminBtn").onclick = () => toggleAdmin();
document.getElementById("shareBtn").onclick = () => shareReferral();

tg.MainButton.setText("ğŸ’° WITHDRAW MONEY").show().onClick(() => {
    userRef.get().then(doc => {
        if (doc.exists && doc.data().balance < 5000) {
            tg.showAlert("âš ï¸ à¦…à¦¨à§à¦¤à¦¤ à§«à§¦à§¦à§¦ à¦ªà§Ÿà§‡à¦¨à§à¦Ÿ à¦ªà§à¦°à§Ÿà§‹à¦œà¦¨!");
        } else {
            const method = prompt("à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦®à¦¾à¦§à§à¦¯à¦® à¦²à¦¿à¦–à§à¦¨ (bkash/nagad/rocket):");
            if (!method || !['bkash', 'nagad', 'rocket'].includes(method.toLowerCase())) {
                return tg.showAlert("âŒ à¦¸à¦ à¦¿à¦• à¦®à¦¾à¦§à§à¦¯à¦® à¦²à¦¿à¦–à§à¦¨ (bkash, nagad à¦…à¦¥à¦¬à¦¾ rocket)");
            }
            const num = prompt(`${method.toUpperCase()} à¦¨à¦®à§à¦¬à¦°à¦Ÿà¦¿ à¦²à¦¿à¦–à§à¦¨:`);
            if (num && num.length >= 11) {
                db.collection("withdraws").add({
                    user_id: user.id,
                    name: user.first_name,
                    number: num,
                    amount: 5000,
                    method: method.toLowerCase(),
                    status: "pending",
                    timestamp: new Date()
                }).then(() => {
                    userRef.update({ balance: firebase.firestore.FieldValue.increment(-5000) });
                    tg.showAlert("âœ… à¦†à¦ªà¦¨à¦¾à¦° " + method.toUpperCase() + " à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿà¦Ÿà¦¿ à¦¸à¦«à¦² à¦¹à§Ÿà§‡à¦›à§‡!");
                });
            } else {
                tg.showAlert("âŒ à¦¸à¦ à¦¿à¦• à¦¨à¦®à§à¦¬à¦° à¦¦à¦¿à¦¨!");
            }
        }
    }).catch(err => tg.showAlert("Error: " + err.message));
});

tg.expand();
</script>
</body>
  </html>
  
